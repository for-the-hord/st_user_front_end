(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bc9bc0e","chunk-2d217eca"],{"66e3":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e._self._c;return t("d2-container",[t("div",{staticClass:"Aone-page"},[t("div",{staticClass:"jigou"},[t("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[t("el-form-item",{attrs:{label:"搜索内容：",prop:"content"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetch()}},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.fetch()}}},[e._v("查询")]),t("el-button",{attrs:{type:"primary_test",icon:"el-icon-plus"},on:{click:function(t){return e.addForm()}}},[e._v("模板导入")]),t("el-button",{attrs:{type:"primary_test",icon:"el-icon-folder-delete"},on:{click:function(t){return e.delRow()}}},[e._v("批量删除")]),t("el-button",{attrs:{type:"primary_test",icon:"el-icon-edit-outline"},on:{click:function(t){return e.addFromwork()}}},[e._v("新建模板")])],1)],1)],1),t("div",{staticClass:"qd-table",staticStyle:{position:"relative",margin:"0 auto"}},[e.tableInfo.data?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableInfo.data,stripe:"","header-cell-style":e.header_style,"cell-style":e.body_style},on:{"cell-mouse-enter":e.hover_table_lds,"row-click":e.goDetail,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"name",label:"模板名称","cell-style":e.timeStyle},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",{staticStyle:{cursor:"pointer"}},[e._v(" "+e._s(n.row.name))])]}}],null,!1,4099046392)}),t("el-table-column",{attrs:{label:"操作",width:"500"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.editRow(n.row)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteRow(n.row)}}},[e._v("删除")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.viewRow(n.row)}}},[e._v("查看")])]}}],null,!1,2564497448)})],1):e._e()],1),t("br"),t("div",{staticClass:"block qd-table"},[e.tableInfo.data.length>0?t("el-pagination",{attrs:{"current-page":e.currentPage_present,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.tableInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage_present=t},"update:current-page":function(t){e.currentPage_present=t}}}):e._e()],1),e.tableInfo.data.length<1?t("div",{staticStyle:{wdith:"100%",color:"white",margin:"200px auto","text-align":"center"}},[t("br"),t("span",{staticClass:"zanwu",staticStyle:{color:"gray"}},[e._v(" 暂无数据")])]):e._e()]),t("transition",{attrs:{name:"fade-scale"}},[e.new_visible?t("div",{staticClass:"new_tan"},[t("div",{staticClass:"new_dio"},[t("i",{staticClass:"el-icon-close new_close",on:{click:e.new_close}}),t("el-form",{ref:"formInline3",staticClass:"demo-form-inline lds_form",attrs:{model:e.formInline3,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"模板名称：",prop:"name"}},[t("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入模板名称"},model:{value:e.formInline3.name,callback:function(t){e.$set(e.formInline3,"name",t)},expression:"formInline3.name"}})],1),t("el-form-item",{attrs:{label:"装备名称：",prop:"equipment_name"}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入装备"},model:{value:e.formInline3.equipment_name,callback:function(t){e.$set(e.formInline3,"equipment_name",t)},expression:"formInline3.equipment_name"}},e._l(e.options_equipment_name,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),(e.flag,t("el-form-item",{attrs:{label:"是否上传文件：",prop:"is_file"}},[t("el-radio",{attrs:{label:"1"},model:{value:e.formInline3.is_file,callback:function(t){e.$set(e.formInline3,"is_file",t)},expression:"formInline3.is_file"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"},model:{value:e.formInline3.is_file,callback:function(t){e.$set(e.formInline3,"is_file",t)},expression:"formInline3.is_file"}},[e._v("否")])],1)),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.flag,expression:"flag == 0"}],attrs:{label:"导入模板："}},[t("input",{staticClass:"Luckyexcel-demo-file",staticStyle:{"font-size":"16px"},attrs:{type:"file",id:"Luckyexcel-demo-file",name:"Luckyexcel-demo-file",value:"导入模板"},on:{change:e.demoHandler}})]),t("div",{staticClass:"luckysheet-content lucky_doudou",staticStyle:{height:"400px"},attrs:{id:"luckysheet"}}),t("br"),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.flag,expression:"flag == 1"}],staticStyle:{"text-align":"right !important"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitRow1("formInline3")}}},[e._v("提交模板")]),t("el-button",{attrs:{type:"primary_test"},on:{click:function(t){return e.reset("formInline3")}}},[e._v("取消")])],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.flag,expression:"flag == 0"}],staticStyle:{"text-align":"right !important"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitRow2("formInline3")}}},[e._v("提交导入")]),t("el-button",{attrs:{type:"primary_test"},on:{click:function(t){return e.reset("formInline3")}}},[e._v("取消")])],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3==e.flag,expression:"flag == 3"}],staticStyle:{"text-align":"right !important"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitRow3("formInline3")}}},[e._v("提交修改")]),t("el-button",{attrs:{type:"primary_test"},on:{click:function(t){return e.reset("formInline3")}}},[e._v("取消")])],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4==e.flag,expression:"flag == 4"}],staticStyle:{"text-align":"right !important"}},[t("el-button",{attrs:{type:"primary",icon:""},on:{click:function(t){return e.doExport()}}},[e._v("导出模板")])],1)],1)],1)]):e._e()])],1)},a=[],i=(n("ed70"),n("c997")),l=n("4ff3"),r=n.n(l),s={name:"Paper",props:{valueFormat:{type:String,default:"timestamp"}},data(){return{gettime:"",turn_blob:null,new_all:null,datas:null,options:{container:"luckysheet",title:"数据填报系统表格",lang:"zh",showtoolbarConfig:!1,data:[{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}]},set_options:[{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}],select_arr:[],loading:!1,flag:0,new_visible:!1,new_visible2:!1,tableInfo:{data:[],total:0},formInline2:{name:"",level:0,page:1,limit:10,code:1},formInline:{name:"",level:0,page:1,limit:10,code:1},dialogInfo2:{title:"",visible:!1,width:"50%",btLoading:!1},formInline3:{id:"",name:"",equipment_name:[],is_file:"",formwork:null},options_equipment_name:[{label:"请输入模板名称",value:"请输入模板名称"}],queryData:{condition:{},page_size:10,page_index:1},rules:{name:[{required:!0,message:"请输入",trigger:"blur"}],equipment_name:[{required:!0,message:"请输入",trigger:"blur"}],is_file:[{required:!0,message:"请选择",trigger:"blur"}]},times:"",excelBuffer:null,file:null,send_file:null,turn_file:null,really_file:null}},created(){this.getFormwork_list()},methods:{getCurrentTime(){var e=this;let t=(new Date).getFullYear(),n=(new Date).getMonth()+1,o=(new Date).getDate(),a=(new Date).getHours(),i=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes(),l=(new Date).getSeconds()<10?"0"+(new Date).getSeconds():(new Date).getSeconds();e.gettime=t+"/"+n+"/"+o+" "+a+":"+i+":"+l},async set_axios(){let e=sessionStorage.getItem("final_blob"),t=localStorage.getItem("final_blob");console.log(e,"new_blobs"),console.log(t,"new_blobs2");var n=new window.FormData;n.append("file",this.file,"test.xlsx"),n.append("id","郭哥"),n.append("name",this.formInline3),n.append("work","lds"),r.a.post("http://localhost:8080/api/addFormwork",n,{}).then((function(e){console.info(e.data,"dddddddddddddd")}))},async sendBlobData(){let e=sessionStorage.getItem("final_blob"),t=localStorage.getItem("final_blob");console.log(e,"new_blobs"),console.log(t,"new_blobs2");const n=new FormData;n.append("file",t);const o=await r.a.post("http://123.57.210.116:89/api/addFormwork",{headers:{"Content-Type":"multipart/form-data"},body:n});console.log(o,"response")},async get_excel(e){let t="http://127.0.0.1:10031";const n=await r()({method:"post",url:t+"/api/getExcelByFormwork",data:{id:e},responseType:"blob"});console.log(n,"aaaaaaaaaaaaaa"),console.log(n.data,"cccccccccc");const o=new window.File([n.data],"Filename.xlsx",{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});console.log("====file====",o),this.file=o,console.log("====file2====",this.file),this.demoHandler2(this.file)},uploadExcel1(e){LuckyExcel.transformExcelToLucky(e,(function(t,n){console.log("transformExcelToLucky",e,t),null!=t.sheets&&0!=t.sheets.length?(luckysheet.destroy(),luckysheet.create({container:"luckysheet",showinfobar:!1,data:t.sheets,title:t.info.name,userInfo:t.info.name.creator,lang:"zh",showinfobar:!1,showtoolbar:!1,enableAddRow:!1,showsheetbarConfig:{add:!1,menu:!1},sheetRightClickConfig:{delete:!1,copy:!1,rename:!1,color:!1,hide:!1,move:!1},cellRightClickConfig:{copy:!1,copyAs:!1,paste:!1,insertRow:!1,insertColumn:!1,deleteRow:!1,deleteColumn:!1,deleteCell:!1,hideRow:!1,hideColumn:!1,rowHeight:!1,columnWidth:!1,clear:!1,matrix:!1,sort:!1,filter:!1,chart:!1,image:!1,link:!1,data:!1,cellFormat:!1}})):alert("Failed to read the content of the excel file, currently does not support xls files!")}))},set_form(){this.formInline3.name="",this.formInline3.equipment_name=[],this.formInline3.is_file="",this.formInline3.formwork=null},addForm(){this.set_form(),this.new_set(),this.flag=0,this.new_visible=!0,this.options.data=this.set_options,setTimeout(()=>{luckysheet.create(this.options),console.log(luckysheet.getluckysheetfile())},100)},new_set(){this.set_options=[{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}]},addFromwork(){this.flag=1,this.new_visible=!0,this.new_set(),this.set_form(),this.options.data=this.set_options,console.log(this.set_options,"setoptions"),console.log(this.options,"options"),setTimeout(()=>{luckysheet.create(this.options),console.log(luckysheet.getluckysheetfile())},100)},setKey(){this.formInline3.name?this.queryData.condition={formwork_name:this.formInline3.name}:this.queryData.condition={}},handleSelectionChange(e){console.log(e,"当前选中");let t=[];e.map(e=>{t.push(e.id)}),this.select_arr=t},delRow(){if(this.select_arr.length<1)this.$message.warning("请选择数据");else{var e={ids:this.select_arr};console.log(e),Object(i["delFormwork"])(e).then(e=>{console.log(e),200==e.code&&(this.getFormwork_list(),this.$message.success(e.msg))})}},handleCurrentChange(e){this.queryData.page_index=e,this.getFormwork_list2()},doExport(){this.getCurrentTime(),console.log(luckysheet.getAllSheets()),console.log(this.formInline3,"当前数据");this.formInline3.equipment_name.toString();let e=""+this.formInline3.name,t=""+this.formInline3.equipment_name;console.log(this.formInline3.equipment_name.toString()),exportSheetExcel(luckysheet,`${e}&${t}&${this.gettime}`)},demoHandler(e){console.log(e,"文件099999"),console.log(e.target.files,"文件11111");let t=document.getElementById("Luckyexcel-demo-file");console.log(t,"upload");let n=document.getElementById("Luckyexcel-select-demo"),o=document.getElementById("Luckyexcel-downlod-file"),a=document.getElementById("lucky-mask-demo");var i=e.target.files;if(console.log(i,"wenjian"),null==i||0==i.length)return void alert("No files wait for import");let l=i[0].name,r=l.split("."),s=r[r.length-1];"xlsx"==s?(LuckyExcel.transformExcelToLucky(i[0],(function(e,t){null!=e.sheets&&0!=e.sheets.length?(console.log(e,t),luckysheet.destroy(),luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")})),n.addEventListener("change",(function(e){var t=n,o=t.selectedIndex,i=t.options[o].value,l=t.options[o].innerHTML;""!=i&&(a.style.display="flex",LuckyExcel.transformExcelToLuckyByUrl(i,l,(function(e,t){null!=e.sheets&&0!=e.sheets.length?(console.log(e,t),a.style.display="none",window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")})))})),o.addEventListener("click",(function(e){var t=n,o=t.selectedIndex,a=t.options[o].value;if(0!=a.length){var i=document.getElementById("Lucky-download-frame");null==i&&(i=document.createElement("iframe"),i.style.display="none",i.id="Lucky-download-frame",document.body.appendChild(i)),i.src=a}else alert("Please select a demo file")}))):alert("Currently only supports the import of xlsx files")},demoHandler2(e){console.log(e,"文件099999");var t=e;console.log(t,"wenjian"),LuckyExcel.transformExcelToLucky(t,(function(e,t){null!=e.sheets&&0!=e.sheets.length?(console.log(e,t),luckysheet.destroy(),luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator,lang:"zh"})):alert("Failed to read the content of the excel file, currently does not support xls files!")})),selectADemo.addEventListener("change",(function(e){var t=selectADemo,n=t.selectedIndex,o=t.options[n].value,a=t.options[n].innerHTML;""!=o&&(mask.style.display="flex",LuckyExcel.transformExcelToLuckyByUrl(o,a,(function(e,t){null!=e.sheets&&0!=e.sheets.length?(console.log(e,t),mask.style.display="none",window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")})))})),downlodDemo.addEventListener("click",(function(e){var t=selectADemo,n=t.selectedIndex,o=t.options[n].value;if(0!=o.length){var a=document.getElementById("Lucky-download-frame");null==a&&(a=document.createElement("iframe"),a.style.display="none",a.id="Lucky-download-frame",document.body.appendChild(a)),a.src=o}else alert("Please select a demo file")}))},new_close(){this.new_visible=!1},new_close2(){this.new_visible2=!1},timeStyle(){return"text-align:center !important"},fetch(){this.getFormwork_list()},getFormwork_list(){this.loading=!0,this.queryData.page_index=1,this.queryData.condition={formwork_name:this.formInline.name||""},this.currentPage_present=1,Object(i["getFormwork"])(this.queryData).then(e=>{this.loading=!1,200==e.code?(this.loading=!1,console.log(e.data),this.tableInfo.data=e.data.records||[],this.tableInfo.total=e.data.total):this.loading=!1})},getFormwork_list2(){this.loading=!0,this.queryData.condition={formwork_name:this.formInline.name||""},Object(i["getFormwork"])(this.queryData).then(e=>{this.loading=!1,200==e.code?(this.loading=!1,console.log(e.data),this.tableInfo.data=e.data.records,this.tableInfo.total=e.data.total):this.loading=!1})},reset(e){this.new_visible=!1,this.$refs[e].resetFields()},resetForm_doudou(e){this.new_visible=!1,this.$refs[e].resetFields()},revokeRow(e,t){let n=new Date,o=parseInt((n.getTime()/1e3).toFixed());if(o>e.begin_date)return void this.$message.warning("评测已开始，暂不可操作！");let a=1===t?"禁用":"启用";this.$confirm(`确定要${a}评测试卷 <span style="color: red">${e.name}</span> 吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning",dangerouslyUseHTMLString:!0}).then(()=>{let n={revoked:t};Object(i["paperRevoke"])(e.id,n).then(e=>{200==e.code?(this.$message.success("操作成功！"),this.fetch()):this.$message.error("操作失败！")})}).catch(()=>{this.$message.info("操作已取消")})},resetForm(e){console.log(e),this.dialogInfo2.visible=!1},editRow(e){this.flag=3,console.log(e,"111"),this.new_visible=!0,this.formInline3.name=e.name,this.formInline3.id=e.id,Object(i["getFormworkItem"])({id:e.id}).then(e=>{console.log(e.data,"9090909"),this.formInline3.is_file=""+e.data[0].is_file;var t=[];t=e.data[0].equipment_list,this.formInline3.equipment_name=[],t.map(e=>{this.formInline3.equipment_name.push(e.equipment_name)})}),this.get_excel(e.id)},viewRow(e){this.new_visible=!0,this.flag=4,this.formInline3.name=e.name,this.formInline3.id=e.id,Object(i["getFormworkItem"])({id:e.id}).then(e=>{console.log(e.data,"9090909"),this.formInline3.is_file=""+e.data[0].is_file;var t=[];t=e.data[0].equipment_list,this.formInline3.equipment_name=[],t.map(e=>{this.formInline3.equipment_name.push(e.equipment_name)})}),this.get_excel(e.id)},deleteRow(e){this.$confirm(`确定要删除<span style="color: red">${e.name}</span>吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning",dangerouslyUseHTMLString:!0}).then(()=>{let t={ids:[e.id]};Object(i["delFormwork"])(t).then(e=>{200==e.code?(this.$message.success("操作成功"),this.getFormwork_list()):this.$message.error("操作失败")})}).catch(()=>{this.$message.info("操作已取消")})},submitRow1(e){this.really_file=null,this.exportSheetExcel_final_blob_vue(luckysheet,"模板的名称lds"),console.log(luckysheet.getAllSheets()),setTimeout(()=>{console.log(this.really_file,"really_file"),this.$refs[e].validate(e=>{if(e){var t=new Blob([this.really_file],{type:"text/plain;charset=utf-8"});console.log(t,"====blob====");var n=new window.FormData;n.append("file",this.really_file,"test.xlsx"),n.append("name",this.formInline3.name),n.append("equipment_name",this.formInline3.equipment_name),n.append("is_file",this.formInline3.is_file),Object(i["addFormwork"])(n).then(e=>{console.log(e,"0000000000"),200==e.code&&(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible=!1,this.fetch(),this.$refs["formInline3"].resetFields())})}})},300)},submitRow2(e){this.really_file=null,this.exportSheetExcel_final_blob_vue(luckysheet,"模板的名称lds"),setTimeout(()=>{this.$refs[e].validate(e=>{if(e){var t=new Blob([this.really_file],{type:"text/plain;charset=utf-8"});console.log(t,"====blob====");var n=new window.FormData;n.append("file",this.really_file,"test.xlsx"),n.append("name",this.formInline3.name),n.append("equipment_name",this.formInline3.equipment_name),n.append("is_file",this.formInline3.is_file),Object(i["addFormwork"])(n).then(e=>{console.log(e,"0000000000"),200==e.code&&(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible=!1,this.fetch(),this.$refs["formInline3"].resetFields())})}})},300)},submitRow3(e){this.really_file=null,this.exportSheetExcel_final_blob_vue(luckysheet,"模板的名称lds"),setTimeout(()=>{this.$refs[e].validate(e=>{if(e){var t=new Blob([this.really_file],{type:"text/plain;charset=utf-8"});console.log(t,"====blob====");var n=new window.FormData;n.append("file",this.really_file,"test.xlsx"),console.log(this.really_file,"====this.really_file===="),n.append("name",this.formInline3.name),n.append("equipment_name",this.formInline3.equipment_name),n.append("is_file",this.formInline3.is_file),n.append("id",this.formInline3.id),Object(i["putFormworkItem"])(n).then(e=>{console.log(e,"0000000000"),200==e.code&&(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible=!1,this.fetch(),this.$refs["formInline3"].resetFields())})}})},300)},initForm(){this.formInline2={name:"",score:"",duration:"",begin_date:"",end_date:"",remark:""}},getTime(e){var t=new Date(1e3*parseInt(e)),n=t.getFullYear(),o=t.getMonth()+1,a=t.getDate();return o=1==o.toString().length?"0"+o:o,a=1==a.toString().length?"0"+a:a,n+"-"+o+"-"+a+" "},async exportSheetExcel_final_blob_vue(e,t){const n=new ExcelJS.Workbook;var o=e.getAllSheets();o.forEach((function(e){if(0===e.data.length)return!0;const t=n.addWorksheet(e.name);return setStyleAndValue(e.data,t),setMerge(e.config.merge,t),setBorder(e,t),setImages(e,t,n),!0}));n.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.ms-excel;charset=utf-8"});console.log(t,"导出成功！"),this.really_file=t})}},mounted(){const e={container:"luckysheet",title:"数据填报系统表格",lang:"zh"};setTimeout(()=>{luckysheet.create(e),console.log(luckysheet.getluckysheetfile())},1e3)}},c=s,u=(n("ddbd"),n("e607")),d=function(e){e.options.__source="src/views/newdata/index.vue"},m=d,f=Object(u["a"])(c,o,a,!1,null,"cc8c1206",null);"function"===typeof m&&m(f);t["default"]=f.exports},"888c":function(e,t,n){},c997:function(e,t,n){"use strict";n.r(t),n.d(t,"getFormwork",(function(){return a})),n.d(t,"getUnitItem",(function(){return i})),n.d(t,"getDataItem",(function(){return l})),n.d(t,"addFormwork",(function(){return r})),n.d(t,"delFormwork",(function(){return s})),n.d(t,"putFormworkItem",(function(){return c})),n.d(t,"getFormworkItem",(function(){return u})),n.d(t,"getEquipmentSearch",(function(){return d})),n.d(t,"getUnitSearch",(function(){return m})),n.d(t,"getFormworkSearch",(function(){return f})),n.d(t,"getDataInfo",(function(){return h})),n.d(t,"getDataInfoItem",(function(){return p})),n.d(t,"getUnit",(function(){return g})),n.d(t,"addUnit",(function(){return y})),n.d(t,"putUnitItem",(function(){return _})),n.d(t,"delUnit",(function(){return b})),n.d(t,"addDataInfo",(function(){return w})),n.d(t,"delDataInfo",(function(){return k})),n.d(t,"putDataInfo",(function(){return v})),n.d(t,"getexcel",(function(){return x})),n.d(t,"new_agency",(function(){return I})),n.d(t,"new_agency2",(function(){return j})),n.d(t,"new_area",(function(){return O})),n.d(t,"new_area2",(function(){return F})),n.d(t,"process",(function(){return q})),n.d(t,"process2",(function(){return C})),n.d(t,"getagency",(function(){return D})),n.d(t,"process3",(function(){return S})),n.d(t,"target",(function(){return $})),n.d(t,"target2",(function(){return E})),n.d(t,"score",(function(){return L})),n.d(t,"detail",(function(){return T})),n.d(t,"dels",(function(){return R})),n.d(t,"puts",(function(){return B})),n.d(t,"getquestion",(function(){return z})),n.d(t,"getcourse",(function(){return U})),n.d(t,"getability",(function(){return H})),n.d(t,"postquestion",(function(){return P})),n.d(t,"putquestion",(function(){return A})),n.d(t,"deletequestion",(function(){return M})),n.d(t,"paperList",(function(){return N})),n.d(t,"paperDelete",(function(){return W})),n.d(t,"paperEdit",(function(){return V})),n.d(t,"paperRevoke",(function(){return G})),n.d(t,"paperCreate",(function(){return J})),n.d(t,"paperQuestion",(function(){return Q})),n.d(t,"paperQuestion2",(function(){return Y})),n.d(t,"getpaper",(function(){return K})),n.d(t,"postpaper",(function(){return X})),n.d(t,"getpapermine",(function(){return Z})),n.d(t,"getresult",(function(){return ee})),n.d(t,"getid",(function(){return te})),n.d(t,"get_look",(function(){return ne})),n.d(t,"top_one",(function(){return oe}));var o=n("dd88");n("86ba");function a(e){return Object(o["a"])({url:"/api/getFormwork",method:"post",data:e})}function i(e){return Object(o["a"])({url:"/api/getUnitItem",method:"post",data:e})}function l(e){return Object(o["a"])({url:"/api/getExcelByData",method:"post",data:e})}function r(e){return Object(o["a"])({url:"/api/addFormwork",method:"post",data:e})}function s(e){return Object(o["a"])({url:"/api/delFormwork",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/api/putFormworkItem",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/api/getFormworkItem",method:"post",data:e})}function d(e){return Object(o["a"])({url:"/api/getEquipmentSearch",method:"post",data:e})}function m(e){return Object(o["a"])({url:"/api/getUnitSearch",method:"post",data:e})}function f(e){return Object(o["a"])({url:"/api/getFormworkSearch",method:"post",data:e})}function h(e){return Object(o["a"])({url:"/api/getDataInfo",method:"post",data:e})}function p(e){return Object(o["a"])({url:"/api/getDataInfoItem",method:"post",data:e})}function g(e){return Object(o["a"])({url:"/api/getUnit",method:"post",data:e})}function y(e){return Object(o["a"])({url:"/api/addUnit",method:"post",data:e})}function _(e){return Object(o["a"])({url:"/api/putUnitItem",method:"post",data:e})}function b(e){return Object(o["a"])({url:"/api/delUnit",method:"post",data:e})}function w(e){return Object(o["a"])({url:"/api/addDataInfo",method:"post",data:e})}function k(e){return Object(o["a"])({url:"/api/delDataInfo",method:"post",data:e})}function v(e){return Object(o["a"])({url:"/api/putDataInfo",method:"post",data:e})}function x(e){return Object(o["a"])({url:"/api/getexcel",method:"post",data:e})}function I(e){return Object(o["a"])({url:"/api/agency/",method:"post",data:e})}function j(e){return Object(o["a"])({url:"/api/agency/",method:"get"})}function O(e){return Object(o["a"])({url:"/api/system/area/?code=100000",method:"get"})}function F(e){return Object(o["a"])({url:"/api/system/area/?code="+e,method:"get"})}function q(e){return Object(o["a"])({url:"/api/agency/process/",method:"post",data:e})}function C(e){return Object(o["a"])({url:"/api/agency/process/",method:"get",params:e})}function D(e){return Object(o["a"])({url:`/api/agency/${e}/`,method:"get"})}function S(e){return Object(o["a"])({url:"/api/agency/process/",method:"put",params:e})}function $(e){return Object(o["a"])({url:"/api/agency/target/",method:"get",params:e})}function E(e){return Object(o["a"])({url:"/api/agency/target/",method:"post",data:e})}function L(e){return Object(o["a"])({url:"/api/agency/target/score/",method:"get",params:e})}function T(e){return Object(o["a"])({url:`/api/agency/process/detail/${e}/`,method:"get"})}function R(e){return Object(o["a"])({url:`/api/agency/${e}/`,method:"DELETE"})}function B(e){return Object(o["a"])({url:`/api/agency/${e}/`,method:"put"})}function z(e){return Object(o["a"])({url:"/api/exam/question/",method:"get",params:e})}function U(e){return Object(o["a"])({url:"/api/exam/course/",method:"get"})}function H(e){return Object(o["a"])({url:"/api/exam/ability/",method:"get"})}function P(e){return Object(o["a"])({url:"/api/exam/question/",method:"post",data:e})}function A(e,t){return Object(o["a"])({url:"/api/exam/question/"+e+"/",method:"put",data:t})}function M(e){return Object(o["a"])({url:`/api/exam/question/${e}/`,method:"DELETE"})}function N(e){return Object(o["a"])({url:"/api/exam/paper/",method:"get",params:e})}function W(e){return Object(o["a"])({url:`/api/exam/paper/${e}/`,method:"delete"})}function V(e,t){return Object(o["a"])({url:`/api/exam/paper/${e}/`,method:"put",data:t})}function G(e,t){return Object(o["a"])({url:`/api/exam/paper/${e}/`,method:"patch",data:t})}function J(e){return Object(o["a"])({url:"/api/exam/paper/",method:"post",data:e})}function Q(e,t){return Object(o["a"])({url:`/api/exam/paper_question/${e}/`,method:"get",params:t})}function Y(e,t){return Object(o["a"])({url:`/api/exam/paper_question/${e}/`,method:"put",data:t})}function K(){return Object(o["a"])({url:"/api/exam/paper/",method:"get"})}function X(e,t){return Object(o["a"])({url:`/api/exam/mine/${e}/`,method:"post",data:t})}function Z(){return Object(o["a"])({url:"/api/exam/mine/",method:"get"})}function ee(e){return Object(o["a"])({url:`/api/exam/result/${e}/`,method:"get"})}function te(e){return Object(o["a"])({url:"/api/exam/mine/",method:"post",data:e})}function ne(e){return Object(o["a"])({url:`/api/exam/mine/${e}/`,method:"get"})}function oe(e){return Object(o["a"])({url:`/api/exam/paper_score/${e}/`,method:"get"})}},ddbd:function(e,t,n){"use strict";n("888c")}}]);
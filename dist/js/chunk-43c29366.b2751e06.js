(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43c29366"],{"257b":function(e,t,s){},"8ff7":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("d2-container",{ref:"",staticStyle:{cursor:"pointer"}},[t("br"),t("qd-filter",{staticStyle:{"margin-left":"30px"},attrs:{label_lds:!0,search_lds:!0,query:e.queryData,"filter-list":e.filterFieldList,"list-type-info":e.listTypeInfo},on:{"update:query":function(t){e.queryData=t},handleClick:e.handleClick}}),t("el-button",{staticClass:"tableHandleBtn",attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.addInfo()}}},[e._v("添加用户")]),t("el-button",{staticClass:"tableHandleBtn",attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:function(t){return e.refresh()}}},[e._v("刷新")]),t("br"),t("br"),t("br"),t("div",{staticClass:"tabletd_center"},[t("qd-table",{ref:"table",staticStyle:{"margin-top":"-10px"},attrs:{refresh:e.tableInfo.refresh,"init-curpage":e.tableInfo.initCurpage,data:e.tableInfo.data,query:e.queryData,"field-list":e.tableFieldList,pager:!0,tabIndex:!0,api:e.getList},on:{"update:data":function(t){return e.$set(e.tableInfo,"data",t)},"update:query":function(t){e.queryData=t},handleClick:e.handleClick,handleEvent:e.handleEvent},scopedSlots:e._u([{key:"col-add_time",fn:function(t){return[e._v(" "+e._s(e.getLocalTime(t.row.add_time))+" ")]}},{key:"col-role_id",fn:function(t){return[e._v(" "+e._s(e.get_role(t.row.role_id))+" ")]}},{key:"col-businessState",fn:function(s){return[0==s.row.businessState?t("span",[e._v("正常")]):e._e(),1==s.row.businessState?t("span",[e._v("终止 ")]):e._e(),2==s.row.businessState?t("span",[e._v("删除")]):e._e()]}},{key:"col-revoked",fn:function(s){return[0==s.row.revoked?t("el-tag",{attrs:{type:"success"}},[e._v("已启用")]):e._e(),1==s.row.revoked?t("el-tag",{attrs:{type:"danger"}},[e._v("已禁用")]):e._e()]}},{key:"col-action",fn:function(s){return[t("span",{staticClass:"lds_tag lds_blue",on:{click:function(t){return e.goInfo(s.row)}}},[e._v("编辑")]),0==s.row.revoked?t("span",{staticClass:"lds_tag lds_red",on:{click:function(t){return e.setInfo(s.row)}}},[e._v("禁用")]):e._e(),1==s.row.revoked?t("span",{staticClass:"lds_tag",on:{click:function(t){return e.setInfo2(s.row)}}},[e._v("启用")]):e._e()]}}])})],1),t("qd-dialog",{attrs:{title:e.dialogInfo.title,visible:e.dialogInfo.visible,width:e.dialogInfo.width,"bt-loading":e.dialogInfo.btLoading,isOk:e.isok},on:{"update:visible":function(t){return e.$set(e.dialogInfo,"visible",t)},handleOk:function(t){return e.submitForm("ruleForm")},quxiao:function(t){return e.quxiao()}}},[t("div",{staticClass:"lds_dialog_form"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"用户账号：",prop:"username"}},[t("el-input",{attrs:{disabled:"add"!=e.usertype},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{label:"登录密码：",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",{attrs:{label:"再次输入密码：",prop:"password_again"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password_again,callback:function(t){e.$set(e.ruleForm,"password_again",t)},expression:"ruleForm.password_again"}})],1),t("el-form-item",{attrs:{label:"用户姓名：",prop:"real_name"}},[t("el-input",{model:{value:e.ruleForm.real_name,callback:function(t){e.$set(e.ruleForm,"real_name",t)},expression:"ruleForm.real_name"}})],1),t("el-form-item",{attrs:{label:"分配角色：",prop:"role_id"}},[t("el-select",{attrs:{placeholder:"请选择分配角色"},model:{value:e.ruleForm.role_id,callback:function(t){e.$set(e.ruleForm,"role_id",t)},expression:"ruleForm.role_id"}},e._l(e.juese,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1)])],1)},a=[],l=(s("00e5"),s("ed70"),s("d017")),i=s("b990"),o={name:"lds_xitong_user",data(){var e=(e,t,s)=>{""==t&&s(new Error("请输入用户名")),t.length<3&&s(new Error("用户名的长度在3-12位")),t.length>12&&s(new Error("用户名的长度在3-12位")),s()},t=(e,t,s)=>{""===t?s(new Error("请输入密码")):t.length<6||t.length>16?s(new Error("密码的长度在6-16位")):(""!==this.ruleForm.password_again&&this.$refs.ruleForm.validateField("password_again"),s())},s=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!==this.ruleForm.password?s(new Error("两次输入密码不一致!")):s()};return{role_id_lds:"",juese:[{name:"管理用户",value:"1"},{name:"营运用户",value:"2"}],value:"",queryData:{real_name:"",username:"",role_id:""},dialogInfo:{title:"查看",visible:!1,width:"600px"},ruleForm:{username:"",password:"",password_again:"",nick_name:"",role_id:"",real_name:""},rules:{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"change"}],password_again:[{validator:s,trigger:"change"}],nick_name:[{required:!0,message:"请输入用户姓名",trigger:"blur"}],role_id:[{required:!0,message:"请选择分配角色",trigger:"change"}]},filterFieldList:[{fieldType:"text",key:"real_name",value:"名称",label_lds:!0},{fieldType:"text",key:"username",value:"账号",label_lds:!0},{fieldType:"select",key:"role_id",value:"角色类型",list:"role_id",label_lds:!0}],listTypeInfo:{role_id:[{value:"",label:"全部"}],siteName:[{value:0,label:"中建八局人才公寓"},{value:1,label:"中建七局明珠小区"},{value:2,label:"其它项目"}]},tableFieldList:[{key:"username",label:"账号"},{key:"real_name",label:"真实姓名"},{key:"add_time",label:"时间",type:"slot"},{key:"add_time",label:"创建时间",type:"slot"},{key:"add_time",label:"最后登录时间",type:"slot"},{key:"revoked",label:"当前状态",type:"slot"},{key:"action",label:"操作",type:"slot",width:"300px",fixed:"right"}],getList:l["l"],userid:""}},methods:{get_roleid(){return sessionStorage.getItem("role_id")},refresh(){this.freshTableList()},quxiao(){for(let e in this.ruleForm)this.ruleForm[e]=""},getLocalTime(e){return new Date(1e3*e).toLocaleString().replace(/:\d{1,2}$/," ")},get_role(e){return i["b"][e]},addInfo(){1==this.role_id_lds?(this.usertype="add",this.dialogInfo.visible=!0,this.dialogInfo.title="新增"):this.$message({type:"warning",message:"当前用户无操作权限"})},setInfo(e){1==this.role_id_lds?(this.usertype="delete",this.dialogInfo.title="禁用",this.$confirm("此操作将永久禁用, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object(l["c"])("","delete",e.id).then(e=>{this.$message({type:"success",message:e.message}),this.freshTableList()})}).catch(()=>{})):this.$message({type:"warning",message:"当前用户无操作权限"})},setInfo2(e){1==this.role_id_lds?(this.usertype="delete",this.dialogInfo.title="启用",this.$confirm("此操作将启用, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object(l["d"])(e.id).then(e=>{this.$message({type:"success",message:e.message}),this.freshTableList()})}).catch(()=>{})):this.$message({type:"warning",message:"当前用户无操作权限"})},goInfo(e){if(this.userid=e.id,1==this.role_id_lds){this.dialogInfo.title="编辑",this.usertype="edit",this.dialogInfo.visible=!0;for(let t in this.ruleForm)this.ruleForm[t]=e[t];this.ruleForm.password=e.real_pwd,this.ruleForm.real_name=e.real_name,this.ruleForm.role_id=e.role_id.toString()}else this.$message({type:"warning",message:"当前用户无操作权限"})},submitForm(e){this.$refs[e].validate(e=>{if(!e)return!1;Object(l["c"])(this.ruleForm,"edit",this.userid).then(e=>{200==e.code?(this.$message({message:e.message,type:"success"}),this.dialogInfo.visible=!1,this.freshTableList()):this.$message({message:e.message,type:"warning"})})})}},created(){this.role_id_lds=sessionStorage.getItem("role_id"),Object(l["j"])().then(e=>{e.data.data.map(e=>{0==e.revoked&&this.listTypeInfo.role_id.push({value:e.id,label:e.name})});let t=this.listTypeInfo.role_id;t.map(e=>{e.name=e.label}),this.juese=t})},watch:{$route:{handler(e,t){e.path.includes("/system")&&setTimeout(()=>{this.freshTableList()},100)},immediate:!0}},mounted(){let e=this;e.socket=this.$sockets("check"),e.socket.emit("SecretCheck",{name:"sgy",age:"11111"}),e.socket.on("SecretCheckResponse",(function(e){})),this.getLocalTime(1619141651),this.freshTableList(),this.refresh()}},n=o,d=(s("df41"),s("e607")),u=function(e){e.options.__source="src/views/admin/user.vue"},c=u,m=Object(d["a"])(n,r,a,!1,null,"10b888ae",null);"function"===typeof c&&c(m);t["default"]=m.exports},df41:function(e,t,s){"use strict";s("257b")}}]);
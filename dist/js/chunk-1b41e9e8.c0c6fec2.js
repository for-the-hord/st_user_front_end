(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b41e9e8","chunk-2d217c1d"],{"62aa":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("d2-container",[e("div",{staticClass:"Aone-page"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.next,expression:"next"}]},[e("div",{staticClass:"mine-head flex_center_around"},t._l(t.head_list,(function(i){return e("div",{staticClass:"item-head flex_center_around"},[e("div",[e("img",{attrs:{src:i.src,alt:""}})]),e("div",[e("p",{staticClass:"names"},[t._v(t._s(i.name))]),e("p",{staticClass:"nums"},[t._v(t._s(i.num))])])])})),0),e("div",{staticClass:"mine-body flex_center_starts2"},[e("div",{staticClass:"company_add pointer flex_center_around_c",on:{click:function(e){return t.go_any()}}},[e("img",{attrs:{src:"/image/AOne/more_c.png",alt:""}}),e("p",{staticClass:"weights fonts-20"},[t._v("认证更多机构")])]),t._l(t.body_list,(function(i){return e("div",{staticClass:"company_add pointer"},[e("div",{staticClass:"company_head flex_center_around",on:{contextmenu:function(e){return e.preventDefault(),t.openMenu(e,i)}}},[t._v(" "+t._s(i.name)+" ")]),e("div",{staticClass:"test flex_center_starts2"},[i.review_score?e("div",{staticClass:"imgs"},[t._v(t._s(i.review_score))]):t._e(),0==i.state?e("span",{staticClass:"heing"},[t._v("审核进行中")]):t._e(),1==i.state?e("span",{staticClass:"heerror"},[t._v("审核未通过")]):t._e(),2==i.state?e("span",{staticClass:"yihe"},[t._v("审核已通过")]):t._e()]),e("div",{staticClass:"bodys"},[e("p",{staticClass:"info-p"},[e("span",{staticClass:"info-left"},[t._v(" 机构类型： ")]),e("span",{staticClass:"info-right"},[t._v(" "+t._s(i.type)+" ")])]),e("p",{staticClass:"info-p"},[e("span",{staticClass:"info-left"},[t._v(" 机构人数： ")]),e("span",{staticClass:"info-right"},[t._v(" "+t._s(i.total_user)+" ")])]),e("p",{staticClass:"info-p"},[e("span",{staticClass:"info-left"},[t._v(" 职称人数： ")]),e("span",{staticClass:"info-right"},[t._v(" "+t._s(i.title_user)+" ")])]),e("p",{staticClass:"info-p"},[e("span",{staticClass:"info-left"},[t._v(" 统一社会信用代码： ")])]),e("p",{staticClass:"info-p"},[e("span",{staticClass:"info-left",staticStyle:{color:"#8f90a6"}},[t._v(" "+t._s(i.code)+" ")])])]),e("div",{staticClass:"fots"},[e("el-button",{attrs:{type:"primary_test"},on:{click:function(e){return t.test_s(i)}}},[t._v("开始评测")])],1)])}))],2)]),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:t.left+"px",top:t.top+"px"}},[e("li",{staticClass:"context_li",on:{click:function(e){return t.go_edit()}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 修改")]),e("li",{staticClass:"context_li",on:{click:function(e){return t.go_delete(t.item)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.next,expression:"!next"}]},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.next,expression:"next"}],staticClass:"renzheng"},[e("p",[t._v("您还未认证任何机构，请先认证机构后进行测评！")]),e("img",{attrs:{src:"/image/AOne/new_nothing.png",alt:""}}),e("br"),e("el-button",{attrs:{type:"renheng"},on:{click:function(e){t.next=!t.next}}},[t._v(" 去认证 ")])],1)]),e("qd-dialog",{attrs:{title:t.dialogInfo.title,visible:t.dialogInfo.visible,width:t.dialogInfo.width,"bt-loading":t.dialogInfo.btLoading,isOk:t.isok,nofooter:!0},on:{"update:visible":function(e){return t.$set(t.dialogInfo,"visible",e)},handleOk:function(e){return t.submitFormhandle()},quxiao:function(e){return t.quxiao()}}},[e("div",{staticClass:"new_renzheng"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"机构名称：",prop:"name",required:""}},[e("el-input",{attrs:{placeholder:"请输入机构名称"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"机构描述：",prop:"description"}},[e("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1),e("el-form-item",{attrs:{label:"信用代码：",prop:"code",required:""}},[e("el-input",{attrs:{placeholder:"请输入机构社会统一信用代码"},model:{value:t.ruleForm.code,callback:function(e){t.$set(t.ruleForm,"code",e)},expression:"ruleForm.code"}})],1),e("el-form-item",{attrs:{label:"所在区域：",prop:"pro"}},[e("el-select",{staticStyle:{width:"30%",float:"left","margin-right":"10px"},attrs:{clearable:"",placeholder:"请选择一级区域"},on:{change:t.get_city},model:{value:t.ruleForm.pro,callback:function(e){t.$set(t.ruleForm,"pro",e)},expression:"ruleForm.pro"}},t._l(t.pro_list,(function(t){return e("el-option",{attrs:{label:t.name,code:t.code,value:t.code}})})),1),t.if_city?e("el-select",{staticStyle:{width:"30%",float:"left","margin-right":"10px"},attrs:{clearable:"",placeholder:"请选择二级区域"},on:{change:t.get_xian},model:{value:t.ruleForm.city,callback:function(e){t.$set(t.ruleForm,"city",e)},expression:"ruleForm.city"}},t._l(t.city_list,(function(t){return e("el-option",{attrs:{label:t.name,value:t.code}})})),1):t._e(),t.if_xian?e("el-select",{staticStyle:{width:"30%",float:"left","margin-right":"10px"},attrs:{clearable:"",placeholder:"请选择三级区域"},model:{value:t.ruleForm.xian,callback:function(e){t.$set(t.ruleForm,"xian",e)},expression:"ruleForm.xian"}},t._l(t.xian_list,(function(t){return e("el-option",{attrs:{label:t.name,value:t.code}})})),1):t._e()],1),e("el-form-item",{attrs:{label:"机构类型：",prop:"type"}},[e("el-select",{attrs:{placeholder:"请选择机构类型"},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.type_list,(function(t){return e("el-option",{attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"详细地址：",prop:"address"}},[e("el-input",{attrs:{placeholder:"请输入机构详细地址"},model:{value:t.ruleForm.address,callback:function(e){t.$set(t.ruleForm,"address",e)},expression:"ruleForm.address"}})],1),e("el-form-item",{attrs:{label:"机构人数：",prop:"total_user"}},[e("el-input",{attrs:{min:"0",placeholder:"请输入机构人数"},model:{value:t.ruleForm.total_user,callback:function(e){t.$set(t.ruleForm,"total_user",e)},expression:"ruleForm.total_user"}})],1),e("el-form-item",{attrs:{label:"职称信息：",required:""}},[e("p",{staticClass:"thead flex_center_around",staticStyle:{width:"65%"}},[e("span",[t._v(" 职称类型 ")]),e("span",[t._v(" 职称人数 ")])]),t._l(t.work_list,(function(i,a){return e("div",{staticStyle:{width:"100%",height:"40px","margin-top":"10px"}},[e("div",{staticStyle:{width:"35%",float:"left"}},[e("el-select",{attrs:{placeholder:"请选择职称类型"},model:{value:i.title_type,callback:function(e){t.$set(i,"title_type",e)},expression:"item.title_type"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticStyle:{width:"25%",float:"left","margin-left":"10px"}},[e("el-input",{attrs:{type:"number",min:"0"},model:{value:i.title_user,callback:function(e){t.$set(i,"title_user",e)},expression:"item.title_user"}})],1),e("div",{staticClass:"pointer",staticStyle:{width:"15%","margin-left":"20px",float:"left"}},[a==t.work_list.length-1?e("i",{staticClass:"el-icon-plus",on:{click:function(e){return t.add_item()}}}):t._e(),0!=a?e("i",{staticClass:"el-icon-minus",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.del_item(a)}}}):t._e()])])}))],2),e("el-form-item",[e("el-button",{staticStyle:{float:"right"},on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("取消")]),e("el-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"primary_test"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v(t._s(t.tijiao))])],1)],1)],1)])],1)},s=[],r=(i("00e5"),i("ed70"),i("c7a4")),n={name:"mine",data(){var t=(t,e,i)=>{e?(e.length<2&&i(new Error("请确保长度在2-8位")),/^[a-zA-Z0-9\u4e00-\u9fa5]*[\u4e00-\u9fa5][a-zA-Z0-9]*$/.test(e)?i():i(new Error("请确保不能为纯数字或者特殊字符"))):i()},e=(t,e,i)=>{e?/^[a-zA-Z0-9\u4e00-\u9fa5]*[\u4e00-\u9fa5][a-zA-Z0-9]*$/.test(e)?i():i(new Error("请确保不能为纯数字或者特殊字符")):i()};return{tijiao:"提交认证",pro_list:[],city_list:[],xian_list:[],next:!0,work_list:[{title_type:"",title_user:""}],type_list:[{label:"企业",value:1},{label:"高校",value:2},{label:"政府",value:3},{label:"科研单位",value:4}],options:[{label:"助理级",value:1},{label:"中级",value:2},{label:"副高级",value:3},{label:"正高级",value:4}],points:"",ruleForm:{name:"",code:"",description:"",area_id:"",address:"",type:1,total_user:"",title:[],pro:"",city:"",xian:""},rules:{name:[{validator:t,trigger:"blur",required:!0}],address:[{validator:e,trigger:"blur",required:!0}],code:[{required:!0,message:"请输入机构社会统一信用代码",trigger:"blur"}],name:[{required:!0,message:"请输入机构名称",trigger:"blur"}],type:[{required:!0,message:"请选择机构类型",trigger:"blur"}],total_user:[{required:!0,message:"请输入机构人数",trigger:"blur"}],pro:[{required:!0,message:"请选择机构所在区域",trigger:"blur"}],address:[{required:!0,message:"请输入机构详细地址",trigger:"blur"}]},dialogInfo:{title:"机构认证",visible:!1,width:"50%"},head_list:[{name:"认证机构总数",num:0,src:"/image/AOne/count.png"},{name:"已通过审核",num:0,src:"/image/AOne/ok.png"},{name:"审核中",num:0,src:"/image/AOne/ing.png"},{name:"审核未通过",num:0,src:"/image/AOne/rejucet.png"}],body_list:[],visible:!1,top:0,left:0,if_city:!1,if_xian:!1,item_id:"",gentral:[11e4,12e4,31e4,5e5],submitType:1}},created(){this.get_agency()},watch:{visible(t,e){t?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},methods:{get_agency(){Object(r["new_agency2"])().then(t=>{0==t.data.list.length&&(this.next=!1),this.body_list=t.data.list,this.head_list[0].num=t.data.total_info.total,this.head_list[1].num=t.data.total_info.pass,this.head_list[2].num=t.data.total_info.hall,this.head_list[3].num=t.data.total_info.fail})},add_item(){this.work_list.push({title_type:"",title_user:""})},del_item(t){this.work_list.splice(t,1)},get_pro(){Object(r["new_area"])().then(t=>{this.pro_list=t.data})},get_city(t){this.if_xian=!1,this.if_city=!1,this.ruleForm.city="",this.ruleForm.xian="",t&&Object(r["new_area2"])(t).then(t=>{this.city_list=t.data,this.city_list.length>0?this.if_city=!0:this.if_city=!1})},get_xian(t){this.if_xian=!1,this.ruleForm.xian="",t&&Object(r["new_area2"])(t).then(t=>{this.xian_list=t.data,this.xian_list=t.data,this.xian_list.length>0?this.if_xian=!0:this.if_xian=!1})},submitForm(t){this.$refs[t].validate(t=>!!t&&(this.ruleForm.pro?(this.ruleForm.title=this.work_list,this.ruleForm.xian&&(this.ruleForm.area_id=this.ruleForm.xian),!this.ruleForm.xian&&this.ruleForm.city&&(this.ruleForm.area_id=this.ruleForm.city),!this.ruleForm.pro||this.ruleForm.xian||this.ruleForm.city||(this.ruleForm.area_id=this.ruleForm.pro),this.ruleForm.title.map(t=>{t.type=parseInt(t.title_type),t.value=parseInt(t.title_user)}),void(1==this.submitType?Object(r["new_agency"])(this.ruleForm).then(t=>{200==t.code?(this.dialogInfo.visible=!1,this.$message.success(t.message),Object(r["new_agency2"])().then(t=>{0==t.data.list.length&&(this.next=!1),this.body_list=t.data.list,this.head_list[0].num=t.data.total_info.total,this.head_list[1].num=t.data.total_info.pass,this.head_list[2].num=t.data.total_info.hall,this.head_list[3].num=t.data.total_info.fail})):this.$message.error("提交失败")}):2==this.submitType&&Object(r["editAgency"])(this.ruleForm,this.item_id).then(t=>{200==t.code?this.$message.success("修改成功"):this.$message.error("修改失败"),this.dialogInfo.visible=!1,this.get_agency()}))):(this.$message.warning("请至少选择省份"),!1)))},resetForm(t){this.$refs[t].resetFields(),this.dialogInfo.visible=!1},test_s(t){0!=t.state?1==t.state?this.$message.warning("请在机构认证审核被拒绝，请联系管理员！"):this.$router.push({path:"/agency/mine_manager",query:{id:t.id}}):this.$message.warning("请在机构认证审核通过后再进行评测！认证审核请联系管理员！")},go_any(){this.dialogInfo.visible=!0,this.tijiao="提交认证",this.submitType=1,this.dialogInfo.title="机构认证",this.initForm(),this.get_pro(),this.ruleForm.type=1},openMenu(t,e){this.item_id=e.id;var i=t.pageX,a=t.pageY;this.top=a,this.left=i,this.visible=!0},closeMenu(){this.visible=!1},go_delete(t){this.$confirm("此操作将永久删除该机构, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(r["dels"])(this.item_id).then(t=>{200==t.code&&(this.$message.success(t.message),Object(r["new_agency2"])().then(t=>{0==t.data.list.length&&(this.next=!1),this.body_list=t.data.list,this.head_list[0].num=t.data.total_info.total,this.head_list[1].num=t.data.total_info.pass,this.head_list[2].num=t.data.total_info.hall,this.head_list[3].num=t.data.total_info.fail}))})})},go_edit(){this.tijiao="提交修改",this.submitType=2,this.initForm(),this.dialogInfo.title="机构修改",this.dialogInfo.visible=!0,Object(r["detail"])(this.item_id).then(t=>{this.ruleForm=t.data,this.work_list=t.data.title,this.deal_area({city_code:t.data.city_code,country_code:t.data.country_code})})},initForm(){this.ruleForm={name:"",code:"",description:"",area_id:"",address:"",type:"",total_user:"",title:[],pro:"",city:"",xian:""},this.work_list=[{title_type:"",title_user:""}],this.pro_list=[],this.city_list=[],this.xian_list=[],this.if_city=!1,this.if_xian=!1},deal_area(t){if(this.get_pro(),this.gentral.indexOf(t.city_code)>=0)this.ruleForm.pro=t.city_code,t.country_code>0&&(this.get_city(this.ruleForm.pro),this.ruleForm.city=t.country_code);else if(t.city_code>0){let e=t.city_code.toString();this.ruleForm.pro=parseInt(e.substring(0,2)+"0000"),this.get_city(this.ruleForm.pro),this.ruleForm.city=t.city_code,t.country_code>0&&(this.get_xian(this.ruleForm.city),this.ruleForm.xian=t.country_code)}}}},l=n,o=(i("f3bf"),i("e607")),c=function(t){t.options.__source="src/views/agency/mine.vue"},u=c,d=Object(o["a"])(l,a,s,!1,null,"096d5f50",null);"function"===typeof u&&u(d);e["default"]=d.exports},b660:function(t,e,i){},c7a4:function(t,e,i){"use strict";i.r(e),i.d(e,"new_agency",(function(){return s})),i.d(e,"new_agency2",(function(){return r})),i.d(e,"new_area",(function(){return n})),i.d(e,"new_area2",(function(){return l})),i.d(e,"process",(function(){return o})),i.d(e,"process2",(function(){return c})),i.d(e,"getagency",(function(){return u})),i.d(e,"process3",(function(){return d})),i.d(e,"target",(function(){return m})),i.d(e,"target2",(function(){return _})),i.d(e,"score",(function(){return h})),i.d(e,"detail",(function(){return p})),i.d(e,"dels",(function(){return f})),i.d(e,"editAgency",(function(){return g}));var a=i("dd88");i("86ba");function s(t){return Object(a["a"])({url:"/api/agency/",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/api/agency/",method:"get"})}function n(t){return Object(a["a"])({url:"/api/system/area/?code=100000",method:"get"})}function l(t){return Object(a["a"])({url:"/api/system/area/?code="+t,method:"get"})}function o(t){return Object(a["a"])({url:"/api/agency/process/",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/api/agency/process/",method:"get",params:t})}function u(t){return Object(a["a"])({url:`/api/agency/${t}/`,method:"get"})}function d(t){return Object(a["a"])({url:"/api/agency/process/",method:"put",params:t})}function m(t){return Object(a["a"])({url:"/api/agency/target/",method:"get",params:t})}function _(t){return Object(a["a"])({url:"/api/agency/target/",method:"post",data:t})}function h(t){return Object(a["a"])({url:"/api/agency/target/score/",method:"get",params:t})}function p(t){return Object(a["a"])({url:`/api/agency/process/detail/${t}/`,method:"get"})}function f(t){return Object(a["a"])({url:`/api/agency/${t}/`,method:"DELETE"})}function g(t,e){return Object(a["a"])({url:`/api/agency/${e}/`,method:"put",data:t})}},f3bf:function(t,e,i){"use strict";i("b660")}}]);
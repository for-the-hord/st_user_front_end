(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a83e87f6","chunk-2d217eca"],{"0364":function(e,l,n){"use strict";n("27f0")},"27f0":function(e,l,n){},"45a5":function(e,l,n){"use strict";n.r(l);var t=function(){var e=this,l=e._self._c;return l("d2-container",[l("div",{staticClass:"Aone-page"},[l("div",{staticClass:"jigou"},[l("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[l("el-form-item",{attrs:{label:"搜索内容：",prop:"data_info"}},[l("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.formInline.data_info,callback:function(l){e.$set(e.formInline,"data_info",l)},expression:"formInline.data_info"}})],1),l("el-form-item",{attrs:{label:"选择单位："}},[l("el-select",{attrs:{multiple:"",prop:"unit_name",clearable:"",placeholder:"请选择单位"},on:{change:e.setChange},model:{value:e.formInline.unit_name,callback:function(l){e.$set(e.formInline,"unit_name",l)},expression:"formInline.unit_name"}},e._l(e.options_unit_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{attrs:{label:"选择模板："}},[l("el-select",{attrs:{multiple:"",prop:"formwork_name",clearable:"",placeholder:"请选择模板"},model:{value:e.formInline.formwork_name,callback:function(l){e.$set(e.formInline,"formwork_name",l)},expression:"formInline.formwork_name"}},e._l(e.options_formwork_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{attrs:{label:"选择装备："}},[l("el-select",{attrs:{multiple:"",prop:"equipment_name",clearable:"",placeholder:"请选择装备"},model:{value:e.formInline.equipment_name,callback:function(l){e.$set(e.formInline,"equipment_name",l)},expression:"formInline.equipment_name"}},e._l(e.options_equipment_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(l){return e.fetch()}}},[e._v("查询")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.resetForm("formInline")}}},[e._v("重置")]),l("el-button",{attrs:{type:"primary_test",icon:"el-icon-plus"},on:{click:function(l){return e.addForm()}}},[e._v("数据导入")]),l("el-button",{attrs:{type:"primary_test",icon:"el-icon-folder-delete"},on:{click:function(l){return e.delRow()}}},[e._v("批量删除")]),l("el-button",{attrs:{type:"primary_test",icon:"el-icon-edit-outline"},on:{click:function(l){return e.addData()}}},[e._v("数据填报")])],1)],1)],1),l("div",{staticClass:"qd-table",staticStyle:{position:"relative",margin:"0 auto"}},[e.tableInfo.data?l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableInfo.data,stripe:"","header-cell-style":e.header_style,"cell-style":e.body_style},on:{"cell-mouse-enter":e.hover_table_lds,"row-click":e.goDetail,"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),l("el-table-column",{attrs:{prop:"name",label:"数据信息","cell-style":e.timeStyle},scopedSlots:e._u([{key:"default",fn:function(n){return[l("span",{staticStyle:{cursor:"pointer"}},[e._v(" "+e._s(n.row.name))])]}}],null,!1,4099046392)}),l("el-table-column",{attrs:{prop:"name",label:"数据概况","cell-style":e.timeStyle},scopedSlots:e._u([{key:"default",fn:function(n){return[l("span",{staticStyle:{cursor:"pointer"}},[e._v(" "+e._s(n.row.unit_name)+" - "+e._s(n.row.user_name)+" - "+e._s(n.row.formwork_name))])]}}],null,!1,3168593575)}),l("el-table-column",{attrs:{label:"操作",width:"500"},scopedSlots:e._u([{key:"default",fn:function(n){return[l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(l){return e.editRow(n.row)}}},[e._v("编辑")]),l("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(l){return e.deleteRow(n.row)}}},[e._v("删除")]),l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(l){return e.viewRow(n.row)}}},[e._v("查看")])]}}],null,!1,2564497448)})],1):e._e()],1),l("br"),l("div",{staticClass:"block qd-table"},[e.tableInfo.data.length>0?l("el-pagination",{attrs:{"current-page":e.currentPage_present,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.tableInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(l){e.currentPage_present=l},"update:current-page":function(l){e.currentPage_present=l}}}):e._e()],1),e.tableInfo.data.length<1?l("div",{staticStyle:{wdith:"100%",color:"white",margin:"200px auto","text-align":"center"}},[l("br"),l("span",{staticClass:"zanwu",staticStyle:{color:"gray"}},[e._v(" 暂无数据")])]):e._e()]),l("transition",{attrs:{name:"fade-scale"}},[l("div",{directives:[{name:"show",rawName:"v-show",value:e.new_visible,expression:"new_visible"}],staticClass:"new_tan"},[l("div",{staticClass:"new_dio"},[l("i",{staticClass:"el-icon-close new_close",on:{click:e.new_close}}),l("el-form",{ref:"formInline3",staticClass:"demo-form-inline lds_form",attrs:{model:e.formInline3,"label-width":"120px"}},[l("el-form-item",{attrs:{label:"模板名称：",prop:"name"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入模板名称"},model:{value:e.formInline3.name,callback:function(l){e.$set(e.formInline3,"name",l)},expression:"formInline3.name"}})],1),l("el-form-item",{attrs:{label:"装备名称：",prop:"equipment_name"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入模板名称"},model:{value:e.formInline3.equipment_name,callback:function(l){e.$set(e.formInline3,"equipment_name",l)},expression:"formInline3.equipment_name"}})],1),l("el-form-item",{attrs:{label:"单位名称：",prop:"unit_name"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入模板名称"},model:{value:e.formInline3.unit_name,callback:function(l){e.$set(e.formInline3,"unit_name",l)},expression:"formInline3.unit_name"}})],1),1==e.flag?l("el-form-item",{attrs:{label:"是否上传文件：",prop:"is_file"}},[l("el-radio",{attrs:{label:"1"},model:{value:e.formInline3.is_file,callback:function(l){e.$set(e.formInline3,"is_file",l)},expression:"formInline3.is_file"}},[e._v("是")]),l("el-radio",{attrs:{label:"0"},model:{value:e.formInline3.is_file,callback:function(l){e.$set(e.formInline3,"is_file",l)},expression:"formInline3.is_file"}},[e._v("否")])],1):e._e(),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.flag,expression:"flag == 0"}],attrs:{label:"上传文件："}},[l("input",{staticClass:"Luckyexcel-demo-file",staticStyle:{"font-size":"16px"},attrs:{type:"file",id:"Luckyexcel-demo-file",name:"Luckyexcel-demo-file",value:"上传文件"},on:{change:e.demoHandler}})]),l("div",{staticClass:"luckysheet-content lucky_doudou",staticStyle:{height:"400px"},attrs:{id:"luckysheet"}}),l("br"),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.flag,expression:"flag == 1"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.submitRow1("formInline3")}}},[e._v("提交模板")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.resetForm_doudou("formInline3")}}},[e._v("取消")])],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.flag,expression:"flag == 0"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.submitRow2("formInline3")}}},[e._v("提交导入")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.reset("formInline3")}}},[e._v("取消")])],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3==e.flag,expression:"flag == 3"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.submitRow3("formInline3")}}},[e._v("提交修改")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.reset("formInline3")}}},[e._v("取消")])],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4==e.flag,expression:"flag == 4"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary",icon:""},on:{click:function(l){return e.doExport()}}},[e._v("导出模板")])],1)],1)],1)])]),l("transition",{attrs:{name:"fade-scale"}},[e.new_visible2?l("div",{staticClass:"new_tan"},[l("div",{staticClass:"new_dio"},[l("i",{staticClass:"el-icon-close new_close",on:{click:e.new_close}}),l("el-form",{ref:"formInline4",staticClass:"demo-form-inline lds_form",attrs:{model:e.formInline4,rules:e.rules4,"label-width":"120px"}},[l("el-form-item",{attrs:{label:"数据名称：",prop:"name"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{disabled:e.realdisabled,placeholder:"请输入数据名称"},model:{value:e.formInline4.name,callback:function(l){e.$set(e.formInline4,"name",l)},expression:"formInline4.name"}})],1),l("el-form-item",{attrs:{label:"装备名称：",prop:"equipment_name"}},[l("el-select",{attrs:{disabled:e.realdisabled,prop:"equipment_name",clearable:"",placeholder:"请选择装备"},model:{value:e.formInline4.equipment_name,callback:function(l){e.$set(e.formInline4,"equipment_name",l)},expression:"formInline4.equipment_name"}},e._l(e.options_equipment_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),l("el-form-item",{attrs:{label:"单位名称：",prop:"unit_name"}},[l("el-select",{attrs:{disabled:e.realdisabled,prop:"unit_name",clearable:"",placeholder:"请选择单位"},on:{change:e.setChange},model:{value:e.formInline4.unit_name,callback:function(l){e.$set(e.formInline4,"unit_name",l)},expression:"formInline4.unit_name"}},e._l(e.options_unit_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.real_is_file,expression:"real_is_file == 1"}],attrs:{label:"上传文件："}},[l("el-upload",{staticClass:"upload-demo",attrs:{action:e.env_url,"on-change":e.handleChange,"on-success":e.handleAvatarSuccess,"auto-upload":"true",multiple:"",name:"file","file-list":e.fileList,"before-upload":e.beforeAvatarUpload}},[l("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),l("el-form-item",{staticStyle:{"text-align":"right !important"}},[l("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.realdisabled,expression:"!realdisabled"}],attrs:{type:"primary"},on:{click:function(l){return e.nexts("formInline4")}}},[e._v("下一步")])],1),l("div",{staticClass:"luckysheet-content lucky_doudou",staticStyle:{height:"400px"},attrs:{id:"luckysheet2"}}),l("br"),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.realdisabled,expression:"realdisabled"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.submitRow5("formInline4")}}},[e._v("提交数据")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.reset2("formInline4")}}},[e._v("取消")])],1)],1)],1)]):e._e()]),l("transition",{attrs:{name:"fade-scale"}},[e.new_visible3?l("div",{staticClass:"new_tan"},[l("div",{staticClass:"new_dio"},[l("i",{staticClass:"el-icon-close new_close",on:{click:e.new_close}}),l("el-form",{ref:"formInline5",staticClass:"demo-form-inline lds_form",attrs:{model:e.formInline5,rules:e.rules4,"label-width":"120px"}},[l("el-form-item",{attrs:{label:"数据名称：",prop:"name"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{disabled:e.realdisabled,placeholder:"请输入数据名称"},model:{value:e.formInline5.name,callback:function(l){e.$set(e.formInline5,"name",l)},expression:"formInline5.name"}})],1),l("el-form-item",{attrs:{label:"装备名称：",prop:"equipment_name"}},[l("el-select",{attrs:{disabled:e.realdisabled,prop:"equipment_name",clearable:"",placeholder:"请选择装备"},model:{value:e.formInline5.equipment_name,callback:function(l){e.$set(e.formInline5,"equipment_name",l)},expression:"formInline5.equipment_name"}},e._l(e.options_equipment_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),l("el-form-item",{attrs:{label:"单位名称：",prop:"unit_name"}},[l("el-select",{attrs:{disabled:e.realdisabled,prop:"unit_name",clearable:"",placeholder:"请选择单位"},on:{change:e.setChange},model:{value:e.formInline5.unit_name,callback:function(l){e.$set(e.formInline5,"unit_name",l)},expression:"formInline5.unit_name"}},e._l(e.options_unit_name,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.real_is_file_data,expression:"real_is_file_data == 1"}],attrs:{label:"上传文件："}},[l("el-upload",{staticClass:"upload-demo",attrs:{action:e.env_url,"auto-upload":"true","on-change":e.handleChange,"on-success":e.handleAvatarSuccess,"on-remove":e.handleRemove,"file-list":e.fileList,"before-upload":e.beforeAvatarUpload}},[l("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),l("el-form-item",{staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.nexts2("formInline5")}}},[e._v("下一步")])],1),l("div",{staticClass:"luckysheet-content lucky_doudou",staticStyle:{height:"400px"},attrs:{id:"luckysheet2"}}),l("br"),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.realdisabled,expression:"realdisabled"}],staticStyle:{"text-align":"right !important"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(l){return e.submitRow5s("formInline5")}}},[e._v("提交修改")]),l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.reset2s("formInline5")}}},[e._v("取消")])],1)],1)],1)]):e._e()]),l("qd-dialog",{attrs:{title:e.dialogInfo2.title,visible:e.dialogInfo2.visible,width:e.dialogInfo2.width,"bt-loading":e.dialogInfo2.btLoading,nofooter:!0},on:{"update:visible":function(l){return e.$set(e.dialogInfo2,"visible",l)}}},[l("p",{staticStyle:{"font-size":"20px","font-weight":"bold",color:"black"}},[e._v("请选择要使用的模板")]),l("div",{staticClass:"mine-body flex_center_starts2"},e._l(e.body_list,(function(n){return l("div",{staticClass:"company_add pointer"},[l("div",{staticClass:"company_head flex_center_around",on:{contextmenu:function(l){return l.preventDefault(),e.openMenu(l,n)}}},[l("span",{staticClass:"chaochu"},[e._v(e._s(n.name)+" ")])]),l("div",{staticClass:"fots",staticStyle:{"margin-top":"40px"}},[l("el-button",{attrs:{type:"primary_test"},on:{click:function(l){return e.test_s(n)}}},[e._v("选择模板")])],1)])})),0)])],1)},a=[],i=(n("ed70"),n("c997")),u=n("92d2"),o={name:"Paper",props:{valueFormat:{type:String,default:"timestamp"}},data(){return{file_name:"",env_url:"",new_show:!0,realdisabled:!1,fileList:[],options:{container:"luckysheet",title:"数据填报系统表格",lang:"zh",showtoolbarConfig:!0,data:[{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}]},options2:{container:"luckysheet2",title:"数据填报系统表格",lang:"zh",showtoolbarConfig:!1,data:[{name:"Cell",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}},{name:"系统配置",color:"",index:0,status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,celldata:[],config:{merge:{},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:315,luckysheet_select_save:[],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{}}]},options3_view:{container:"luckysheet",title:"数据填报系统表格",lang:"zh",showtoolbarConfig:!1,data:[]},options_unit_name:[],options_formwork_name:[],options_equipment_name:[],select_arr:[],loading:!1,flag:0,new_visible:!1,new_visible2:!1,new_visible3:!1,tableInfo:{data:[],total:0},formInline3:{name:"",equipment_name:"",unit_name:"",is_file:""},formInline4:{name:"",equipment_name:"",unit_name:"",is_file:""},formInline5:{name:"",equipment_name:"",unit_name:"",is_file:""},formInline:{data_info:"",unit_name:[],formwork_name:[],equipment_name:[]},dialogInfo2:{title:"",visible:!1,width:"70%",btLoading:!1},formInline3:{name:"",equipment_name:"",is_file:"",formwork:{}},queryData:{condition:{},page_size:10,page_index:1},rules:{name:[{required:!0,message:"请输入",trigger:"blur"}],equipment_name:[{required:!0,message:"请输入",trigger:"blur"}],unit_name:[{required:!0,message:"请输入",trigger:"blur"}],is_file:[{required:!0,message:"请选择",trigger:"blur"}]},rules4:{name:[{required:!0,message:"请输入",trigger:"blur"}],equipment_name:[{required:!0,message:"请输入",trigger:"blur"}],unit_name:[{required:!0,message:"请输入",trigger:"blur"}],is_file:[{required:!0,message:"请选择",trigger:"blur"}]},body_list:[],form_id:"",unit_id:"",equipment_id:"",viewData:null,data_id:"",real_is_file:"",real_is_file_data:"",new_id_list:[]}},created(){this.env_url="http://localhost:8080/api/upload",this.getDataInfo_list(),this.getU(),Object(i["getEquipmentSearch"])({}).then(e=>{console.log(e,"9999"),this.options_equipment_name=e.data}),Object(i["getFormworkSearch"])({}).then(e=>{console.log(e,"89809980"),this.options_formwork_name=e.data,this.body_list=e.data})},methods:{nexts(e){this.new_show=!1,this.$refs[e].validate(e=>{e?(this.realdisabled=!0,this.options2.data[1].celldata=[{r:0,c:0,v:{m:""+this.form_id,ct:{fa:"General",t:"g"},v:""+this.form_id}},{r:0,c:1,v:{m:""+this.formInline4.unit_name,ct:{fa:"General",t:"g"},v:""+this.formInline4.unit_name}},{r:0,c:2,v:{m:""+this.formInline4.equipment_name,ct:{fa:"General",t:"g"},v:""+this.formInline4.equipment_name}}],setTimeout(()=>{luckysheet.create(this.options2),console.log(luckysheet.getluckysheetfile())},100)):this.$message.warning("请提交完整信息")})},nexts2(e){this.new_show=!1,this.$refs[e].validate(e=>{e?(this.realdisabled=!0,this.options2.data=this.viewData,setTimeout(()=>{luckysheet.create(this.options2),console.log(luckysheet.getluckysheetfile())},100)):this.$message.warning("请提交完整信息")})},handleChange(e){console.log(e,"09xxxxxx")},handleAvatarSuccess(e,l,n){console.log(e,"当前成功返回"),200==e.code?(this.new_id_list.push({id:e.data.id,name:e.data.name}),console.log(this.new_id_list,"new_id_list")):this.$message.error(e.msg)},beforeAvatarUpload(e){console.log(e,"999")},submitRow5(){console.log("新增数据",this.formInline4);let e=u["a"].cookies.get("user_id"),l=luckysheet.getluckysheetfile();console.log(l,"dataall");let n={name:this.formInline4.name,formwork_id:this.form_id,data_info:l,user_id:e,unit_id:this.formInline4.unit_name,equipment_name:this.formInline4.equipment_name,files:this.new_id_list};Object(i["addDataInfo"])(n).then(e=>{console.log(e,"0000000000"),200==e.code?(this.$message.success(e.msg),this.new_visible2=!1,this.fetch()):this.$message.warning(e.msg)})},submitRow5s(){console.log("修改数据",this.formInline5);let e=u["a"].cookies.get("user_id"),l=luckysheet.getluckysheetfile();console.log(l,"dataall");let n={name:this.formInline5.name,formwork_id:this.form_id,data_info:l,user_id:e,unit_id:this.formInline5.unit_name,equipment_name:this.formInline5.equipment_name,files:[],id:this.data_id};Object(i["putDataInfo"])(n).then(e=>{console.log(e,"0000000000"),200==e.code?(this.$message.success(e.msg),this.new_visible2=!1,this.new_visible=!1,this.new_visible3=!1):this.$message.warning(e.msg)})},test_s(e){this.formInline4={name:"",equipment_name:"",unit_name:"",is_file:""},console.log(e,"999999999999999"),this.form_id=e.id,this.real_is_file=e.is_file,this.new_visible2=!0,this.dialogInfo2.visible=!1,this.options2.data[0].data=[],this.options2.data[0].config.merge={}},getU(){Object(i["getUnitSearch"])().then(e=>{console.log(e),this.options_unit_name=e.data})},addData(){this.dialogInfo2.visible=!0},handleSelectionChange(e){console.log(e,"当前选中");let l=[];e.map(e=>{l.push(e.id)}),this.select_arr=l},delRow(){if(this.select_arr.length<1)this.$message.warning("请选择数据");else{var e={ids:this.select_arr};console.log(e),Object(i["delDataInfo"])(e).then(e=>{console.log(e),200==e.code&&(this.getDataInfo_list(),this.$message.success(e.msg))})}},handleCurrentChange(e){this.queryData.page_index=e,this.getDataInfo_list2()},addForm(){this.flag=0,this.new_visible=!0,setTimeout(()=>{luckysheet.create(this.options),console.log(luckysheet.getluckysheetfile())},100)},doExport(){console.log(luckysheet.getAllSheets()),exportSheetExcel(luckysheet,"file")},demoHandler(e){console.log(e.target.files,"文件11111");let l=document.getElementById("Luckyexcel-demo-file");console.log(l,"upload");let n=document.getElementById("Luckyexcel-select-demo"),t=document.getElementById("Luckyexcel-downlod-file"),a=document.getElementById("lucky-mask-demo");var i=e.target.files;if(console.log(i,"wenjian"),null==i||0==i.length)return void alert("No files wait for import");let u=i[0].name,o=u.split("."),r=o[o.length-1];"xlsx"==r?(LuckyExcel.transformExcelToLucky(i[0],(function(e,l){null!=e.sheets&&0!=e.sheets.length?(console.log(e,l),luckysheet.destroy(),luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")})),n.addEventListener("change",(function(e){var l=n,t=l.selectedIndex,i=l.options[t].value,u=l.options[t].innerHTML;""!=i&&(a.style.display="flex",LuckyExcel.transformExcelToLuckyByUrl(i,u,(function(e,l){null!=e.sheets&&0!=e.sheets.length?(console.log(e,l),a.style.display="none",window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:e.sheets,title:e.info.name,userInfo:e.info.name.creator})):alert("Failed to read the content of the excel file, currently does not support xls files!")})))})),t.addEventListener("click",(function(e){var l=n,t=l.selectedIndex,a=l.options[t].value;if(0!=a.length){var i=document.getElementById("Lucky-download-frame");null==i&&(i=document.createElement("iframe"),i.style.display="none",i.id="Lucky-download-frame",document.body.appendChild(i)),i.src=a}else alert("Please select a demo file")}))):alert("Currently only supports the import of xlsx files")},new_close(){this.new_visible=!1,this.new_visible2=!1,this.new_visible3=!1,this.realdisabled=!1,this.$refs["formInline4"].resetFields()},timeStyle(){return"text-align:center !important"},fetch(){this.getDataInfo_list()},addFromwork(){this.flag=1,this.new_visible=!0,setTimeout(()=>{luckysheet.create(this.options),console.log(luckysheet.getluckysheetfile())},100)},getDataInfo_list(){this.loading=!0,this.queryData.page_index=1,this.queryData.condition={data_info:this.formInline.data_info||"",formwork_id:this.formInline.formwork_name,equipment_name:this.formInline.equipment_name,unit_id:this.formInline.unit_name},this.currentPage_present=1,Object(i["getDataInfo"])(this.queryData).then(e=>{this.loading=!1,console.log(e.data),this.tableInfo.data=e.data.records,this.tableInfo.total=e.data.total})},getDataInfo_list2(){this.loading=!0,this.queryData.condition={formwork_name:this.formInline.name||""},Object(i["getDataInfo"])(this.queryData).then(e=>{console.log(e.data),this.loading=!1,this.tableInfo.data=e.data.records,this.tableInfo.total=e.data.total})},reset(e){this.new_visible=!1,this.realdisabled=!1,this.$refs[e].resetFields()},reset2(e){this.new_visible2=!1,this.realdisabled=!1,this.$refs[e].resetFields()},reset2s(e){this.new_visible3=!1,this.realdisabled=!1,this.$refs[e].resetFields()},revokeRow(e,l){let n=new Date,t=parseInt((n.getTime()/1e3).toFixed());if(t>e.begin_date)return void this.$message.warning("评测已开始，暂不可操作！");let a=1===l?"禁用":"启用";this.$confirm(`确定要${a}评测试卷 <span style="color: red">${e.name}</span> 吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning",dangerouslyUseHTMLString:!0}).then(()=>{let n={revoked:l};Object(i["paperRevoke"])(e.id,n).then(e=>{200==e.code?(this.$message.success("操作成功！"),this.fetch()):this.$message.error("操作失败！")})}).catch(()=>{this.$message.info("操作已取消")})},resetForm(e){console.log(e),this.formInline.data_info="",this.formInline.unit_name=[],this.formInline.formwork_name=[],this.formInline.equipment_name=[],this.fetch()},editRow(e){this.flag=3,console.log(e,"111"),this.new_visible3=!0,this.data_id=e.id,this.formInline5.name=e.name,this.formInline5.equipment_name=e.equipment_name,Object(i["getDataInfoItem"])({id:e.id}).then(e=>{console.log(e,"89089089"),this.formInline5.name=e.data.name,this.formInline5.equipment_name=e.data.equipment_name,this.formInline5.unit_name=e.data.unit_name,this.viewData=JSON.parse(e.data.data_info),this.real_is_file_data=e.data.is_file,console.log(this.viewData,"viewData"),this.fileList=[],e.data.files.map(e=>{this.fileList.push(e)}),console.log(this.fileList,"fileList")})},viewRow(e){this.new_visible=!0,this.flag=4,Object(i["getDataInfoItem"])({id:e.id}).then(e=>{console.log(e,"89089089"),this.formInline3.name=e.data.name,this.formInline3.equipment_name=e.data.equipment_name,this.formInline3.unit_name=e.data.unit_name,this.viewData=JSON.parse(e.data.data_info),console.log(this.viewData,"viewData"),this.options3_view.data[0]=this.viewData[0];let l=this.viewData[1].data[0];console.log(l,"new_data_red"),this.options3_view.data[1]={name:"系统配置",color:"",index:"Sheet_f00i1Mloe4bk_1681698517950",status:1,order:0,hide:0,row:36,column:18,defaultRowHeight:19,defaultColWidth:73,config:{merge:{"1_0":{r:1,c:0,rs:2,cs:3}},rowlen:{},columnlen:{},rowhidden:{},colhidden:{},borderInfo:{},authority:{}},scrollLeft:0,scrollTop:0,luckysheet_select_save:[{left:0,width:221,top:19,height:40,left_move:0,width_move:221,top_move:20,height_move:39,row:[1,2],column:[0,2],row_focus:1,column_focus:0}],calcChain:[],isPivotTable:!1,pivotTable:{},filter_select:{},filter:null,luckysheet_alternateformat_save:[],luckysheet_alternateformat_save_modelCustom:[],luckysheet_conditionformat_save:{},frozen:{},chart:[],zoomRatio:1,image:[],showGridLines:1,dataVerification:{},data:[l,[{mc:{r:1,c:0,rs:2,cs:3},m:"请注意，当前表格页数据不可删除！",ct:{fa:"General",t:"g"},v:"请注意，当前表格页数据不可删除！",fc:"#ff0000",bl:1},{mc:{r:1,c:0},fc:"#ff0000",bl:1},{mc:{r:1,c:0},fc:"#ff0000",bl:1},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[{mc:{r:1,c:0},fc:"#ff0000",bl:1},{mc:{r:1,c:0},fc:"#ff0000",bl:1},{mc:{r:1,c:0},fc:"#ff0000",bl:1},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],load:"1",freezen:null,jfgird_select_save:[],visibledatarow:[20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400,420,440,460,480,500,520,540,560,580,600,620,640,660,680,700,720],visibledatacolumn:[74,148,222,296,370,444,518,592,666,740,814,888,962,1036,1110,1184,1258,1332],ch_width:1452,rh_height:800,luckysheet_selection_range:[]},setTimeout(()=>{luckysheet.create(this.options3_view),console.log(luckysheet.getluckysheetfile())},100)})},updateRow(e){let l=new Date,n=parseInt((l.getTime()/1e3).toFixed());n>e.begin_date?this.$message.warning("评测已开始，暂不可操作！"):e.exist?this.$message.warning("试卷已完成，暂不可操作！"):this.$router.push({path:"/exam/paper/detail",query:{paperId:e.id}})},updateRow2(e){e.exist?this.$router.push({path:"/exam/paper/detail2",query:{paperId:e.id}}):this.$message.warning("试卷未完成选题！")},deleteRow(e){this.$confirm(`确定要删除<span style="color: red">${e.name}</span>吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning",dangerouslyUseHTMLString:!0}).then(()=>{let l={ids:[e.id]};Object(i["delFormwork"])(l).then(e=>{200==e.code?(this.$message.success("操作成功"),this.getDataInfo_list()):this.$message.error("操作失败")})}).catch(()=>{this.$message.info("操作已取消")})},submitRow1(e){console.log("新增数据"),console.log(this.formInline3),console.log(luckysheet.getAllSheets()[0]),this.formInline3.formwork=luckysheet.getAllSheets()[0],this.$refs[e].validate(e=>{e&&Object(i["addFormwork"])(this.formInline3).then(e=>{console.log(e,"0000000000"),200==e.code?(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible=!1):this.$message.warning(e.msg)})})},submitRow2(e){console.log("新增导入"),this.formInline3.formwork=luckysheet.getAllSheets()[0],this.$refs[e].validate(e=>{e&&Object(i["addFormwork"])(this.formInline3).then(e=>{console.log(e,"0000000000"),200==e.code?(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible=!1):this.$message.warning(e.msg)})})},submitRow3(e){console.log("新增修改"),this.formInline3.formwork=luckysheet.getAllSheets(),this.$refs[e].validate(e=>{e&&Object(i["putDataInfo"])(this.formInline3).then(e=>{console.log(e,"0000000000"),200==e.code?(this.$message.success(e.msg),luckysheet.destroy(),this.new_visible2=!1):this.$message.warning(e.msg)})})},beginChange(){this.formInline2.begin_date=this.paperBegin/1e3||0},endChange(){this.formInline2.end_date=this.paperEnd/1e3||0},initForm(){this.formInline2={name:"",score:"",duration:"",begin_date:"",end_date:"",remark:""}},getTime(e){var l=new Date(1e3*parseInt(e)),n=l.getFullYear(),t=l.getMonth()+1,a=l.getDate();return t=1==t.toString().length?"0"+t:t,a=1==a.toString().length?"0"+a:a,n+"-"+t+"-"+a+" "}},mounted(){const e={container:"luckysheet",title:"数据填报系统表格",lang:"zh"};setTimeout(()=>{luckysheet.create(e),console.log(luckysheet.getluckysheetfile())},1e3)}},r=o,s=(n("0364"),n("e607")),c=function(e){e.options.__source="src/views/newdata/paper copy.vue"},m=c,d=Object(s["a"])(r,t,a,!1,null,"6bb6c9b8",null);"function"===typeof m&&m(d);l["default"]=d.exports},c997:function(e,l,n){"use strict";n.r(l),n.d(l,"getFormwork",(function(){return a})),n.d(l,"getUnitItem",(function(){return i})),n.d(l,"getDataItem",(function(){return u})),n.d(l,"addFormwork",(function(){return o})),n.d(l,"delFormwork",(function(){return r})),n.d(l,"putFormworkItem",(function(){return s})),n.d(l,"getFormworkItem",(function(){return c})),n.d(l,"getEquipmentSearch",(function(){return m})),n.d(l,"getUnitSearch",(function(){return d})),n.d(l,"getFormworkSearch",(function(){return f})),n.d(l,"getDataInfo",(function(){return h})),n.d(l,"getDataInfoItem",(function(){return p})),n.d(l,"getUnit",(function(){return _})),n.d(l,"addUnit",(function(){return g})),n.d(l,"putUnitItem",(function(){return b})),n.d(l,"delUnit",(function(){return w})),n.d(l,"addDataInfo",(function(){return y})),n.d(l,"delDataInfo",(function(){return v})),n.d(l,"putDataInfo",(function(){return I})),n.d(l,"getexcel",(function(){return k})),n.d(l,"new_agency",(function(){return x})),n.d(l,"new_agency2",(function(){return q})),n.d(l,"new_area",(function(){return j})),n.d(l,"new_area2",(function(){return O})),n.d(l,"process",(function(){return $})),n.d(l,"process2",(function(){return C})),n.d(l,"getagency",(function(){return S})),n.d(l,"process3",(function(){return D})),n.d(l,"target",(function(){return L})),n.d(l,"target2",(function(){return F})),n.d(l,"score",(function(){return R})),n.d(l,"detail",(function(){return T})),n.d(l,"dels",(function(){return E})),n.d(l,"puts",(function(){return z})),n.d(l,"getquestion",(function(){return U})),n.d(l,"getcourse",(function(){return N})),n.d(l,"getability",(function(){return A})),n.d(l,"postquestion",(function(){return B})),n.d(l,"putquestion",(function(){return P})),n.d(l,"deletequestion",(function(){return H})),n.d(l,"paperList",(function(){return G})),n.d(l,"paperDelete",(function(){return M})),n.d(l,"paperEdit",(function(){return J})),n.d(l,"paperRevoke",(function(){return V})),n.d(l,"paperCreate",(function(){return W})),n.d(l,"paperQuestion",(function(){return Q})),n.d(l,"paperQuestion2",(function(){return Y})),n.d(l,"getpaper",(function(){return K})),n.d(l,"postpaper",(function(){return X})),n.d(l,"getpapermine",(function(){return Z})),n.d(l,"getresult",(function(){return ee})),n.d(l,"getid",(function(){return le})),n.d(l,"get_look",(function(){return ne})),n.d(l,"top_one",(function(){return te}));var t=n("dd88");n("86ba");function a(e){return Object(t["a"])({url:"/api/getFormwork",method:"post",data:e})}function i(e){return Object(t["a"])({url:"/api/getUnitItem",method:"post",data:e})}function u(e){return Object(t["a"])({url:"/api/getExcelByData",method:"post",data:e})}function o(e){return Object(t["a"])({url:"/api/addFormwork",method:"post",data:e})}function r(e){return Object(t["a"])({url:"/api/delFormwork",method:"post",data:e})}function s(e){return Object(t["a"])({url:"/api/putFormworkItem",method:"post",data:e})}function c(e){return Object(t["a"])({url:"/api/getFormworkItem",method:"post",data:e})}function m(e){return Object(t["a"])({url:"/api/getEquipmentSearch",method:"post",data:e})}function d(e){return Object(t["a"])({url:"/api/getUnitSearch",method:"post",data:e})}function f(e){return Object(t["a"])({url:"/api/getFormworkSearch",method:"post",data:e})}function h(e){return Object(t["a"])({url:"/api/getDataInfo",method:"post",data:e})}function p(e){return Object(t["a"])({url:"/api/getDataInfoItem",method:"post",data:e})}function _(e){return Object(t["a"])({url:"/api/getUnit",method:"post",data:e})}function g(e){return Object(t["a"])({url:"/api/addUnit",method:"post",data:e})}function b(e){return Object(t["a"])({url:"/api/putUnitItem",method:"post",data:e})}function w(e){return Object(t["a"])({url:"/api/delUnit",method:"post",data:e})}function y(e){return Object(t["a"])({url:"/api/addDataInfo",method:"post",data:e})}function v(e){return Object(t["a"])({url:"/api/delDataInfo",method:"post",data:e})}function I(e){return Object(t["a"])({url:"/api/putDataInfo",method:"post",data:e})}function k(e){return Object(t["a"])({url:"/api/getexcel",method:"post",data:e})}function x(e){return Object(t["a"])({url:"/api/agency/",method:"post",data:e})}function q(e){return Object(t["a"])({url:"/api/agency/",method:"get"})}function j(e){return Object(t["a"])({url:"/api/system/area/?code=100000",method:"get"})}function O(e){return Object(t["a"])({url:"/api/system/area/?code="+e,method:"get"})}function $(e){return Object(t["a"])({url:"/api/agency/process/",method:"post",data:e})}function C(e){return Object(t["a"])({url:"/api/agency/process/",method:"get",params:e})}function S(e){return Object(t["a"])({url:`/api/agency/${e}/`,method:"get"})}function D(e){return Object(t["a"])({url:"/api/agency/process/",method:"put",params:e})}function L(e){return Object(t["a"])({url:"/api/agency/target/",method:"get",params:e})}function F(e){return Object(t["a"])({url:"/api/agency/target/",method:"post",data:e})}function R(e){return Object(t["a"])({url:"/api/agency/target/score/",method:"get",params:e})}function T(e){return Object(t["a"])({url:`/api/agency/process/detail/${e}/`,method:"get"})}function E(e){return Object(t["a"])({url:`/api/agency/${e}/`,method:"DELETE"})}function z(e){return Object(t["a"])({url:`/api/agency/${e}/`,method:"put"})}function U(e){return Object(t["a"])({url:"/api/exam/question/",method:"get",params:e})}function N(e){return Object(t["a"])({url:"/api/exam/course/",method:"get"})}function A(e){return Object(t["a"])({url:"/api/exam/ability/",method:"get"})}function B(e){return Object(t["a"])({url:"/api/exam/question/",method:"post",data:e})}function P(e,l){return Object(t["a"])({url:"/api/exam/question/"+e+"/",method:"put",data:l})}function H(e){return Object(t["a"])({url:`/api/exam/question/${e}/`,method:"DELETE"})}function G(e){return Object(t["a"])({url:"/api/exam/paper/",method:"get",params:e})}function M(e){return Object(t["a"])({url:`/api/exam/paper/${e}/`,method:"delete"})}function J(e,l){return Object(t["a"])({url:`/api/exam/paper/${e}/`,method:"put",data:l})}function V(e,l){return Object(t["a"])({url:`/api/exam/paper/${e}/`,method:"patch",data:l})}function W(e){return Object(t["a"])({url:"/api/exam/paper/",method:"post",data:e})}function Q(e,l){return Object(t["a"])({url:`/api/exam/paper_question/${e}/`,method:"get",params:l})}function Y(e,l){return Object(t["a"])({url:`/api/exam/paper_question/${e}/`,method:"put",data:l})}function K(){return Object(t["a"])({url:"/api/exam/paper/",method:"get"})}function X(e,l){return Object(t["a"])({url:`/api/exam/mine/${e}/`,method:"post",data:l})}function Z(){return Object(t["a"])({url:"/api/exam/mine/",method:"get"})}function ee(e){return Object(t["a"])({url:`/api/exam/result/${e}/`,method:"get"})}function le(e){return Object(t["a"])({url:"/api/exam/mine/",method:"post",data:e})}function ne(e){return Object(t["a"])({url:`/api/exam/mine/${e}/`,method:"get"})}function te(e){return Object(t["a"])({url:`/api/exam/paper_score/${e}/`,method:"get"})}}}]);
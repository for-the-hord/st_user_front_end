<template>  <div class="uploadClass">    <el-upload      :action="uploadUrl()"      :limit="limitNum"      :auto-upload="false"      accept=".xlsx,.xls"      :before-upload="beforeUploadFile"      :on-change="fileChange"      :on-exceed="exceedFile"      :on-success="uploadSuccess"      :on-error="uploadError"      :file-list="fileList"    >      <i class="el-icon-upload">选择文件</i>    </el-upload>    <br/>    <el-button size="small" type="primary" @click="uploadFile">立即上传</el-button>    <el-button size="small">取消</el-button>  </div></template><script>export default {  name: "Upload",  data() {    return {      limitNum: 1,      fileList: []    }  },  methods: {    // 文件超出限制钩子    exceedFile: function (files, fileList) {      this.$message.warning(`只能选择${this.limitNum}个文件，当前已经选择了${files.length + fileList.length}个`)    },    // 文件状态改变时钩子    fileChange: function (file, fileList) {      this.fileList.push(file.raw)    },    // 上传文件前钩子    beforeUploadFile: function (file) {      let extension = file.name.substring(file.name.lastIndexOf(".") + 1);      console.log(extension)      let size = file.size / 1024 / 1024;      if (extension !== "xlsx" && extension !== "xls") {        this.$message.warning("只能上传Excel文件")      }      if (size > 10) {        this.$message.warning("文件大小不得超过10M")      }    },    // 文件上传成功钩子    uploadSuccess: function (res, file, fileList) {      this.fileList = [];      this.$message.success("文件上传成功")    },    // 文件上传失败钩子    uploadError: function (res, file, fileList) {      this.$message.error("文件上传失败")    },    uploadUrl: function () {      return ""    },    uploadFile: function () {      if (this.fileList.length === 0) {        this.$message.warning("请选择文件")      } else {        let form = new FormData();        form.append("file", this.fileList[0]);        let uploadUrl = "http://127.0.0.1:5001/api/upload/1/";        this.$axios.post(uploadUrl, form).then((res) => {          console.log(res)          // code: 536c63d2-0f0a-426c-bdf7-452a2a837121          let that = this;          that.socket = this.$sockets("process");          that.socket.emit("BatchDeal", {code: res.data.data.code, type: 1});          that.socket.on(`BatchDealResponse`, function (res) {            console.log(res);          });          this.uploadSuccess();        }).catch(() => {          this.uploadError()        })      }    }  }}</script><style scoped>.uploadClass {  display: inline-block !important;}.el-icon-upload {  font-size: 20px !important;  color: #ffffff !important;}</style>